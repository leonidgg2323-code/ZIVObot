<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>ZIVO</title>
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#00b4ff">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="ZIVO">
<meta name="mobile-web-app-capable" content="yes">
<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;600;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root{--bg:#050a14;--bg2:#0a1628;--blue:#00b4ff;--blue2:#0066cc;--blue-glow:rgba(0,180,255,0.3);--white:#e8f4ff;--gray:#3a5a7a;--danger:#ff4466;--success:#00ffaa;--card:rgba(10,22,40,0.8)}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--white);font-family:'Exo 2',sans-serif;min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(0,180,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(0,180,255,0.03) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0}
.app{position:relative;z-index:1;max-width:420px;margin:0 auto;min-height:100vh;display:flex;flex-direction:column}
.header{padding:20px 24px 16px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid rgba(0,180,255,0.1)}
.logo{font-size:28px;font-weight:900;letter-spacing:4px;color:var(--white);text-shadow:0 0 20px var(--blue),0 0 40px var(--blue2)}
.logo span{color:var(--blue)}
.status-dot{width:10px;height:10px;border-radius:50%}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.5;transform:scale(0.8)}}
.header-right{display:flex;align-items:center;gap:10px;font-size:11px;font-family:'Share Tech Mono',monospace}
.page{display:none;flex:1;padding:0 16px 100px}
.zivo-face-container{display:flex;flex-direction:column;align-items:center;padding:24px 0}
.zivo-face{width:160px;height:160px;background:linear-gradient(135deg,#0d1f3a,#1a3a5c);border-radius:32px;border:2px solid var(--gray);display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;transition:all 0.5s}
.zivo-face::before{content:'';position:absolute;top:0;left:-100%;width:60%;height:100%;background:linear-gradient(90deg,transparent,rgba(0,180,255,0.1),transparent);animation:scan 3s infinite}
@keyframes scan{0%{left:-100%}100%{left:200%}}
.eyes{display:flex;gap:28px;position:relative;z-index:1}
.eye{width:32px;height:32px;background:var(--blue);border-radius:8px;box-shadow:0 0 20px var(--blue);animation:blink 4s infinite;position:relative;overflow:hidden}
.eye::after{content:'';position:absolute;top:4px;left:4px;width:10px;height:10px;background:rgba(255,255,255,0.6);border-radius:3px}
@keyframes blink{0%,90%,100%{transform:scaleY(1)}95%{transform:scaleY(0.1)}}
.zivo-name{margin-top:14px;font-size:22px;font-weight:900;letter-spacing:6px;color:var(--blue);text-shadow:0 0 16px var(--blue-glow)}
.zivo-mood{margin-top:4px;font-size:11px;font-family:'Share Tech Mono',monospace;color:var(--gray);letter-spacing:2px}
.stats-row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin:16px 0}
.stat-card{background:var(--card);border:1px solid rgba(0,180,255,0.15);border-radius:16px;padding:14px 10px;text-align:center;backdrop-filter:blur(10px)}
.stat-value{font-size:20px;font-weight:700;color:var(--blue);font-family:'Share Tech Mono',monospace}
.stat-label{font-size:9px;color:var(--gray);letter-spacing:1px;text-transform:uppercase;margin-top:3px}
.battery-card{background:var(--card);border:1px solid rgba(0,180,255,0.15);border-radius:16px;padding:16px;margin-bottom:12px;backdrop-filter:blur(10px)}
.battery-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.battery-title{font-size:11px;letter-spacing:2px;text-transform:uppercase;color:var(--gray)}
.battery-percent{font-family:'Share Tech Mono',monospace;font-size:18px;color:var(--success)}
.battery-bar{height:8px;background:rgba(0,180,255,0.1);border-radius:4px;overflow:hidden}
.battery-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--blue2),var(--blue));border-radius:4px;box-shadow:0 0 8px var(--blue-glow);transition:width 0.5s}
.section-title{font-size:11px;letter-spacing:3px;text-transform:uppercase;color:var(--gray);margin:20px 0 12px}
.dpad{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;width:200px;margin:0 auto 24px}
.dpad-btn{height:56px;background:var(--card);border:1px solid rgba(0,180,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;cursor:pointer;transition:all 0.15s;user-select:none}
.dpad-btn:active{background:var(--blue);box-shadow:0 0 20px var(--blue-glow);transform:scale(0.95)}
.dpad-center{background:rgba(0,180,255,0.1);border-color:var(--blue);font-size:12px;font-weight:700;color:var(--blue);letter-spacing:1px}
.dpad-empty{background:transparent;border:none}
.action-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px}
.action-btn{padding:16px;background:var(--card);border:1px solid rgba(0,180,255,0.2);border-radius:16px;text-align:center;cursor:pointer;transition:all 0.2s}
.action-btn:active{transform:scale(0.97);border-color:var(--blue)}
.action-icon{font-size:24px;margin-bottom:6px}
.action-label{font-size:11px;letter-spacing:1px;text-transform:uppercase;color:var(--gray)}
.lang-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px}
.lang-btn{padding:14px;background:var(--card);border:1px solid rgba(0,180,255,0.15);border-radius:14px;text-align:center;cursor:pointer;transition:all 0.2s}
.lang-btn.active{border-color:var(--blue);background:rgba(0,180,255,0.1);box-shadow:0 0 12px var(--blue-glow)}
.lang-flag{font-size:26px}
.lang-name{font-size:11px;color:var(--gray);margin-top:4px;letter-spacing:1px}
.toggle-row{display:flex;align-items:center;justify-content:space-between;padding:16px;background:var(--card);border:1px solid rgba(0,180,255,0.15);border-radius:14px;margin-bottom:10px}
.toggle-label{font-size:14px;font-weight:600}
.toggle-desc{font-size:11px;color:var(--gray);margin-top:2px}
.toggle{width:48px;height:26px;background:var(--gray);border-radius:13px;position:relative;cursor:pointer;transition:background 0.2s;flex-shrink:0}
.toggle.on{background:var(--blue);box-shadow:0 0 10px var(--blue-glow)}
.toggle::after{content:'';position:absolute;top:3px;left:3px;width:20px;height:20px;background:white;border-radius:50%;transition:transform 0.2s}
.toggle.on::after{transform:translateX(22px)}
.boundary-map{width:100%;aspect-ratio:1;background:var(--card);border:1px solid rgba(0,180,255,0.2);border-radius:20px;position:relative;overflow:hidden;margin-bottom:16px}
.boundary-map::before{content:'';position:absolute;inset:0;background-image:linear-gradient(rgba(0,180,255,0.05) 1px,transparent 1px),linear-gradient(90deg,rgba(0,180,255,0.05) 1px,transparent 1px);background-size:30px 30px}
.boundary-zone{position:absolute;inset:30px;border:2px dashed var(--blue);border-radius:12px;box-shadow:0 0 20px var(--blue-glow),inset 0 0 20px rgba(0,180,255,0.05)}
.zivo-dot{position:absolute;width:20px;height:20px;background:var(--blue);border-radius:6px;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:0 0 16px var(--blue);animation:float 3s ease-in-out infinite}
@keyframes float{0%,100%{transform:translate(-50%,-50%) translateY(0)}50%{transform:translate(-50%,-50%) translateY(-6px)}}
.corner-handle{position:absolute;width:14px;height:14px;background:var(--blue);border-radius:3px;box-shadow:0 0 8px var(--blue)}
.boundary-info{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.info-card{background:var(--card);border:1px solid rgba(0,180,255,0.15);border-radius:14px;padding:14px}
.info-card-label{font-size:10px;color:var(--gray);letter-spacing:1px;text-transform:uppercase}
.info-card-value{font-size:18px;font-weight:700;color:var(--blue);font-family:'Share Tech Mono',monospace;margin-top:4px}
.bottom-nav{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:420px;background:rgba(5,10,20,0.95);border-top:1px solid rgba(0,180,255,0.15);display:flex;padding:10px 0 20px;backdrop-filter:blur(20px);z-index:100}
.nav-item{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;cursor:pointer;padding:6px 0;transition:all 0.2s}
.nav-icon{font-size:22px;filter:grayscale(1) opacity(0.4);transition:all 0.2s}
.nav-label{font-size:9px;letter-spacing:1px;text-transform:uppercase;color:var(--gray)}
.nav-item.active .nav-icon{filter:none}
.nav-item.active .nav-label{color:var(--blue)}
.log-entry{display:flex;gap:10px;padding:10px 14px;background:var(--card);border:1px solid rgba(0,180,255,0.1);border-radius:12px;margin-bottom:8px;align-items:flex-start}
.log-time{font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--gray);white-space:nowrap;padding-top:2px}
.log-text{font-size:13px;line-height:1.4}
.log-text.info{color:var(--blue)}
.log-text.warn{color:#ffaa00}
.log-text.ok{color:var(--success)}
</style>
</head>
<body>
<div class="app">
  <div class="header">
    <div class="logo">ZI<span>V</span>O</div>
    <div class="header-right">
      <div class="status-dot" id="status-dot" style="background:var(--gray);box-shadow:none;animation:none;"></div>
      <span id="status-text" style="color:var(--gray)"></span>
    </div>
  </div>

  <div class="zivo-face-container">
    <div class="zivo-face" id="zivo-face">
      <div class="eyes"><div class="eye"></div><div class="eye"></div></div>
    </div>
    <div class="zivo-name">ZIVO</div>
    <div class="zivo-mood" id="mood-text"></div>
  </div>

  <div id="offline-banner" style="text-align:center;padding:16px 20px;color:var(--gray);">
    <div style="font-size:40px;margin-bottom:10px;">üì°</div>
    <div style="font-size:13px;font-weight:600;letter-spacing:2px;margin-bottom:4px;" data-t="not_connected"></div>
    <div style="font-size:11px;opacity:0.6;margin-bottom:20px;" data-t="not_connected_desc"></div>
    <div style="background:var(--card);border:1px solid rgba(0,180,255,0.2);border-radius:16px;padding:18px;text-align:left;">
      <div style="font-size:10px;letter-spacing:2px;color:var(--gray);margin-bottom:8px;" data-t="serial_label"></div>
      <input id="serial-input" type="text" maxlength="12"
        style="width:100%;background:rgba(0,180,255,0.05);border:1px solid rgba(0,180,255,0.3);border-radius:10px;padding:12px 14px;color:var(--white);font-family:'Share Tech Mono',monospace;font-size:16px;letter-spacing:3px;outline:none;text-transform:uppercase;"
        placeholder="ZIVO-XXXXXX" oninput="this.value=this.value.toUpperCase()"/>
      <div id="serial-error" style="font-size:11px;color:var(--danger);margin-top:8px;display:none;" data-t="serial_wrong"></div>
      <button onclick="tryConnect()" id="connect-btn"
        style="width:100%;margin-top:14px;padding:13px;background:rgba(0,180,255,0.1);border:1px solid var(--blue);border-radius:12px;cursor:pointer;font-size:12px;letter-spacing:2px;color:var(--blue);font-family:'Exo 2',sans-serif;font-weight:700;"
        data-t="connect_btn"></button>
    </div>
    <div style="margin-top:14px;font-size:11px;opacity:0.5;" data-t="serial_hint"></div>
  </div>

  <div id="pages-wrapper" style="display:none">
    <div id="page-home" class="page" style="display:block">
      <div class="stats-row">
        <div class="stat-card"><div class="stat-value" id="temp-val">--</div><div class="stat-label" data-t="temp"></div></div>
        <div class="stat-card"><div class="stat-value" id="uptime-val">--</div><div class="stat-label" data-t="uptime"></div></div>
        <div class="stat-card"><div class="stat-value">‚úì</div><div class="stat-label">Wi-Fi</div></div>
      </div>
      <div class="battery-card">
        <div class="battery-header">
          <span class="battery-title" data-t="battery"></span>
          <span class="battery-percent" id="batt-text">--%</span>
        </div>
        <div class="battery-bar"><div class="battery-fill" id="batt-fill"></div></div>
      </div>
      <div class="section-title" data-t="log"></div>
      <div id="log-list"></div>
    </div>

    <div id="page-control" class="page">
      <div class="section-title" data-t="movement"></div>
      <div class="dpad">
        <div class="dpad-btn dpad-empty"></div>
        <div class="dpad-btn" onclick="sendCmd('forward')">‚ñ≤</div>
        <div class="dpad-btn dpad-empty"></div>
        <div class="dpad-btn" onclick="sendCmd('left')">‚óÑ</div>
        <div class="dpad-btn dpad-center">ZIVO</div>
        <div class="dpad-btn" onclick="sendCmd('right')">‚ñ∫</div>
        <div class="dpad-btn dpad-empty"></div>
        <div class="dpad-btn" onclick="sendCmd('backward')">‚ñº</div>
        <div class="dpad-btn dpad-empty"></div>
      </div>
      <div class="section-title" data-t="actions"></div>
      <div class="action-grid">
        <div class="action-btn" onclick="sendCmd('wake')"><div class="action-icon">üé§</div><div class="action-label" data-t="wakeup"></div></div>
        <div class="action-btn" onclick="sendCmd('sleep')"><div class="action-icon">üò¥</div><div class="action-label" data-t="sleep"></div></div>
        <div class="action-btn" onclick="sendCmd('charge')"><div class="action-icon">üîã</div><div class="action-label" data-t="charge"></div></div>
        <div class="action-btn" onclick="sendCmd('dance')"><div class="action-icon">üé≤</div><div class="action-label" data-t="random"></div></div>
      </div>
    </div>

    <div id="page-boundary" class="page">
      <div class="section-title" data-t="zonemap"></div>
      <div class="boundary-map">
        <div class="boundary-zone">
          <div class="corner-handle" style="top:-7px;left:-7px"></div>
          <div class="corner-handle" style="top:-7px;right:-7px"></div>
          <div class="corner-handle" style="bottom:-7px;left:-7px"></div>
          <div class="corner-handle" style="bottom:-7px;right:-7px"></div>
        </div>
        <div class="zivo-dot"></div>
      </div>
      <div class="boundary-info">
        <div class="info-card"><div class="info-card-label" data-t="zonewidth"></div><div class="info-card-value">80cm</div></div>
        <div class="info-card"><div class="info-card-label" data-t="zonedepth"></div><div class="info-card-value">60cm</div></div>
        <div class="info-card"><div class="info-card-label" data-t="edgealerts"></div><div class="info-card-value" style="color:var(--success)" data-t="on"></div></div>
        <div class="info-card"><div class="info-card-label" data-t="falls"></div><div class="info-card-value">0</div></div>
      </div>
    </div>
  </div>

  <div id="page-settings" class="page" style="display:none">
    <div class="section-title" data-t="language"></div>
    <div class="lang-grid">
      <div class="lang-btn" onclick="selectLang(this,'ru')"><div class="lang-flag">üá∑üá∫</div><div class="lang-name">–†—É—Å—Å–∫–∏–π</div></div>
      <div class="lang-btn active" onclick="selectLang(this,'en')"><div class="lang-flag">üá∫üá∏</div><div class="lang-name">English</div></div>
      <div class="lang-btn" onclick="selectLang(this,'he')"><div class="lang-flag">üáÆüá±</div><div class="lang-name">◊¢◊ë◊®◊ô◊™</div></div>
      <div class="lang-btn" onclick="selectLang(this,'zh')"><div class="lang-flag">üá®üá≥</div><div class="lang-name">‰∏≠Êñá</div></div>
      <div class="lang-btn" onclick="selectLang(this,'uk')"><div class="lang-flag">üá∫üá¶</div><div class="lang-name">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</div></div>
    </div>
    <div class="section-title" data-t="features"></div>
    <div class="toggle-row"><div class="toggle-info"><div class="toggle-label" data-t="voiceact"></div><div class="toggle-desc" data-t="voiceact_desc"></div></div><div class="toggle on" onclick="this.classList.toggle('on')"></div></div>
    <div class="toggle-row"><div class="toggle-info"><div class="toggle-label" data-t="edgeprot"></div><div class="toggle-desc" data-t="edgeprot_desc"></div></div><div class="toggle on" onclick="this.classList.toggle('on')"></div></div>
    <div class="toggle-row"><div class="toggle-info"><div class="toggle-label" data-t="autocharge"></div><div class="toggle-desc" data-t="autocharge_desc"></div></div><div class="toggle on" onclick="this.classList.toggle('on')"></div></div>
    <div class="toggle-row"><div class="toggle-info"><div class="toggle-label" data-t="explore"></div><div class="toggle-desc" data-t="explore_desc"></div></div><div class="toggle" onclick="this.classList.toggle('on')"></div></div>
    <div class="toggle-row"><div class="toggle-info"><div class="toggle-label" data-t="notifs"></div><div class="toggle-desc" data-t="notifs_desc"></div></div><div class="toggle on" onclick="this.classList.toggle('on')"></div></div>
  </div>

  <div class="bottom-nav">
    <div class="nav-item active" onclick="switchPage('home',this)"><div class="nav-icon">ü§ñ</div><div class="nav-label">ZIVO</div></div>
    <div class="nav-item" onclick="switchPage('control',this)"><div class="nav-icon">üïπÔ∏è</div><div class="nav-label" data-t="nav_control"></div></div>
    <div class="nav-item" onclick="switchPage('boundary',this)"><div class="nav-icon">üìç</div><div class="nav-label" data-t="nav_zone"></div></div>
    <div class="nav-item" onclick="switchPage('settings',this)"><div class="nav-icon">‚öôÔ∏è</div><div class="nav-label" data-t="nav_settings"></div></div>
  </div>
</div>

<script>
const REGISTERED_ROBOTS = {
  'ZIVO-ADMINMW': { name: 'ZIVO #1', owner: 'Admin' },
};

const T = {
  ru: {
    online:'–í –°–ï–¢–ò',temp:'–¢–ï–ú–ü',uptime:'–í–†–ï–ú–Ø',battery:'–ë–ê–¢–ê–†–ï–Ø',log:'–ñ–£–†–ù–ê–õ',
    movement:'–î–í–ò–ñ–ï–ù–ò–ï',actions:'–î–ï–ô–°–¢–í–ò–Ø',
    wakeup:'–†–ê–ó–ë–£–î–ò–¢–¨',sleep:'–°–ü–ê–¢–¨',charge:'–ù–ê –ó–ê–†–Ø–î–ö–£',random:'–¢–ê–ù–¶–ï–í–ê–¢–¨',
    zonemap:'–ö–ê–†–¢–ê –ó–û–ù–´',zonewidth:'–®–ò–†–ò–ù–ê',zonedepth:'–ì–õ–£–ë–ò–ù–ê',
    edgealerts:'–ó–ê–©–ò–¢–ê –ö–†–ê–Ø',on:'–í–ö–õ',falls:'–ü–ê–î–ï–ù–ò–ô',
    language:'–Ø–ó–´–ö',features:'–§–£–ù–ö–¶–ò–ò',
    voiceact:'–ì–æ–ª–æ—Å–æ–≤–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è',voiceact_desc:'–ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ñ—Ä–∞–∑–æ–π "–ü—Ä–∏–≤–µ—Ç ZIVO"',
    edgeprot:'–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–∞–¥–µ–Ω–∏—è',edgeprot_desc:'–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è —É –∫—Ä–∞—è —Å—Ç–æ–ª–∞',
    autocharge:'–ê–≤—Ç–æ –∑–∞—Ä—è–¥–∫–∞',autocharge_desc:'–ï—Ö–∞—Ç—å –Ω–∞ –±–∞–∑—É –ø—Ä–∏ –Ω–∏–∑–∫–æ–º –∑–∞—Ä—è–¥–µ',
    explore:'–°–ª—É—á–∞–π–Ω—ã–µ –ø—Ä–æ–≥—É–ª–∫–∏',explore_desc:'ZIVO –µ–∑–¥–∏—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ',
    notifs:'–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è',notifs_desc:'–ó–∞—Ä—è–¥ –∏ –∑–∞—â–∏—Ç–∞ –∫—Ä–∞—è',
    nav_control:'–£–ü–†–ê–í–õ–ï–ù–ò–ï',nav_zone:'–ó–û–ù–ê',nav_settings:'–ù–ê–°–¢–†–û–ô–ö–ò',
    moods:['–ì–û–¢–û–í ‚Ä¢ –°–õ–£–®–ê–Æ','–ò–°–°–õ–ï–î–£–Æ','–°–ß–ê–°–¢–õ–ò–í','–ñ–î–£ –ö–û–ú–ê–ù–î–´'],
    log_connected:'–ü–æ–¥–∫–ª—é—á—ë–Ω –∫ {name}',
    upfmt:(h,m)=>h+'—á'+String(m).padStart(2,'0')+'–º',
    offline:'–ù–ï –ü–û–î–ö–õ–Æ–ß–Å–ù',not_connected:'ZIVO –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω',
    not_connected_desc:'–í–≤–µ–¥–∏ —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä',connect_btn:'–ü–û–î–ö–õ–Æ–ß–ò–¢–¨',
    serial_label:'–°–ï–†–ò–ô–ù–´–ô –ù–û–ú–ï–†',serial_wrong:'–ù–µ–≤–µ—Ä–Ω—ã–π —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä.',
    serial_hint:'–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –Ω–∞ –Ω–∞–∫–ª–µ–π–∫–µ –Ω–∞ –¥–Ω–µ –∫–æ—Ä–ø—É—Å–∞'
  },
  en: {
    online:'ONLINE',temp:'TEMP',uptime:'UPTIME',battery:'BATTERY',log:'LOG',
    movement:'MOVEMENT',actions:'ACTIONS',
    wakeup:'WAKE UP',sleep:'SLEEP',charge:'GO CHARGE',random:'DANCE',
    zonemap:'SAFE ZONE MAP',zonewidth:'WIDTH',zonedepth:'DEPTH',
    edgealerts:'EDGE ALERTS',on:'ON',falls:'FALLS',
    language:'LANGUAGE',features:'FEATURES',
    voiceact:'Voice Activation',voiceact_desc:'Wake up with "Hey ZIVO"',
    edgeprot:'Edge Protection',edgeprot_desc:'Stop at table edges',
    autocharge:'Auto Charging',autocharge_desc:'Return to base when low',
    explore:'Random Explore',explore_desc:'ZIVO moves on its own',
    notifs:'Notifications',notifs_desc:'Battery and edge alerts',
    nav_control:'CONTROL',nav_zone:'ZONE',nav_settings:'SETTINGS',
    moods:['READY ‚Ä¢ LISTENING','EXPLORING','HAPPY','IDLE ‚Ä¢ WAITING'],
    log_connected:'Connected to {name}',
    upfmt:(h,m)=>h+'h'+String(m).padStart(2,'0')+'m',
    offline:'DISCONNECTED',not_connected:'ZIVO is not connected',
    not_connected_desc:'Enter your ZIVO serial number',connect_btn:'CONNECT',
    serial_label:'SERIAL NUMBER',serial_wrong:'Wrong serial number.',
    serial_hint:'Serial number is on the sticker on the bottom'
  },
  he: {
    online:'◊û◊ó◊ï◊ë◊®',temp:'◊ò◊û◊§',uptime:'◊ñ◊û◊ü',battery:'◊°◊ï◊ú◊ú◊î',log:'◊ô◊ï◊û◊ü',
    movement:'◊™◊†◊ï◊¢◊î',actions:'◊§◊¢◊ï◊ú◊ï◊™',
    wakeup:'◊î◊™◊¢◊ï◊®◊®',sleep:'◊©◊ô◊†◊î',charge:'◊ú◊ò◊¢◊ô◊†◊î',random:'◊ú◊®◊ß◊ï◊ì',
    zonemap:'◊û◊§◊™ ◊ê◊ñ◊ï◊®',zonewidth:'◊®◊ï◊ó◊ë',zonedepth:'◊¢◊ï◊û◊ß',
    edgealerts:'◊î◊í◊†◊™ ◊ß◊¶◊î',on:'◊§◊ï◊¢◊ú',falls:'◊†◊§◊ô◊ú◊ï◊™',
    language:'◊©◊§◊î',features:'◊™◊õ◊ï◊†◊ï◊™',
    voiceact:'◊î◊§◊¢◊ú◊î ◊ß◊ï◊ú◊ô◊™',voiceact_desc:'◊î◊§◊¢◊ú◊î ◊¢◊ù "◊î◊ô◊ô ZIVO"',
    edgeprot:'◊î◊í◊†◊î ◊û◊†◊§◊ô◊ú◊î',edgeprot_desc:'◊¢◊¶◊ï◊® ◊ë◊ß◊¶◊î ◊î◊©◊ï◊ú◊ó◊ü',
    autocharge:'◊ò◊¢◊ô◊†◊î ◊ê◊ï◊ò◊ï◊û◊ò◊ô◊™',autocharge_desc:'◊ó◊ñ◊ï◊® ◊ú◊ë◊°◊ô◊° ◊õ◊©◊î◊°◊ï◊ú◊ú◊î ◊†◊û◊ï◊õ◊î',
    explore:'◊°◊ô◊ï◊® ◊ê◊ß◊®◊ê◊ô',explore_desc:'ZIVO ◊†◊ï◊°◊¢ ◊ú◊ë◊ì',
    notifs:'◊î◊™◊®◊ê◊ï◊™',notifs_desc:'◊°◊ï◊ú◊ú◊î ◊ï◊î◊í◊†◊™ ◊ß◊¶◊î',
    nav_control:'◊©◊ú◊ô◊ò◊î',nav_zone:'◊ê◊ñ◊ï◊®',nav_settings:'◊î◊í◊ì◊®◊ï◊™',
    moods:['◊û◊ï◊õ◊ü ‚Ä¢ ◊û◊ß◊©◊ô◊ë','◊ó◊ï◊ß◊®','◊©◊û◊ó','◊û◊û◊™◊ô◊ü'],
    log_connected:'◊û◊ó◊ï◊ë◊® ◊ú-{name}',
    upfmt:(h,m)=>h+'◊©'+String(m).padStart(2,'0')+'◊ì',
    offline:'◊û◊†◊ï◊™◊ß',not_connected:'ZIVO ◊ú◊ê ◊û◊ó◊ï◊ë◊®',
    not_connected_desc:'◊î◊ñ◊ü ◊ê◊™ ◊î◊û◊°◊§◊® ◊î◊°◊ô◊ì◊ï◊®◊ô',connect_btn:'◊î◊™◊ó◊ë◊®',
    serial_label:'◊û◊°◊§◊® ◊°◊ô◊ì◊ï◊®◊ô',serial_wrong:'◊û◊°◊§◊® ◊°◊ô◊ì◊ï◊®◊ô ◊©◊í◊ï◊ô.',
    serial_hint:'◊î◊û◊°◊§◊® ◊î◊°◊ô◊ì◊ï◊®◊ô ◊†◊û◊¶◊ê ◊ë◊™◊ó◊™◊ô◊™ ZIVO'
  },
  zh: {
    online:'Âú®Á∫ø',temp:'Ê∏©Â∫¶',uptime:'ËøêË°å',battery:'ÁîµÊ±†',log:'Êó•Âøó',
    movement:'ÁßªÂä®',actions:'Êìç‰Ωú',
    wakeup:'Âî§ÈÜí',sleep:'Áù°Áú†',charge:'ÂéªÂÖÖÁîµ',random:'Ë∑≥Ëàû',
    zonemap:'ÂÆâÂÖ®Âå∫Âüü',zonewidth:'ÂÆΩÂ∫¶',zonedepth:'Ê∑±Â∫¶',
    edgealerts:'ËæπÁºò‰øùÊä§',on:'ÂºÄÂêØ',falls:'Ë∑åËêΩ',
    language:'ËØ≠Ë®Ä',features:'ÂäüËÉΩ',
    voiceact:'ËØ≠Èü≥ÊøÄÊ¥ª',voiceact_desc:'ËØ¥"Âòø ZIVO"Âî§ÈÜí',
    edgeprot:'Èò≤Ë∑åËêΩ',edgeprot_desc:'Âú®Ê°åÂ≠êËæπÁºòÂÅú‰∏ã',
    autocharge:'Ëá™Âä®ÂÖÖÁîµ',autocharge_desc:'ÁîµÈáè‰ΩéÊó∂ËøîÂõûÂÖÖÁîµ',
    explore:'ÈöèÊú∫Êé¢Á¥¢',explore_desc:'ZIVO Ëá™‰∏ªÁßªÂä®',
    notifs:'ÈÄöÁü•',notifs_desc:'ÁîµÊ±†ÂíåËæπÁºòË≠¶Êä•',
    nav_control:'ÊéßÂà∂',nav_zone:'Âå∫Âüü',nav_settings:'ËÆæÁΩÆ',
    moods:['ÂáÜÂ§áÂ•Ω‰∫Ü','Êé¢Á¥¢‰∏≠','ÂºÄÂøÉ','Á≠âÂæÖÂëΩ‰ª§'],
    log_connected:'Â∑≤ËøûÊé•Âà∞ {name}',
    upfmt:(h,m)=>h+'Êó∂'+String(m).padStart(2,'0')+'ÂàÜ',
    offline:'Êú™ËøûÊé•',not_connected:'ZIVO Êú™ËøûÊé•',
    not_connected_desc:'ËæìÂÖ•Â∫èÂàóÂè∑',connect_btn:'ËøûÊé•',
    serial_label:'Â∫èÂàóÂè∑',serial_wrong:'Â∫èÂàóÂè∑ÈîôËØØ„ÄÇ',
    serial_hint:'Â∫èÂàóÂè∑Âú® ZIVO Â∫ïÈÉ®ÁöÑË¥¥Á∫∏‰∏ä'
  },
  uk: {
    online:'–í –ú–ï–†–ï–ñ–Ü',temp:'–¢–ï–ú–ü',uptime:'–ß–ê–°',battery:'–ë–ê–¢–ê–†–ï–Ø',log:'–ñ–£–†–ù–ê–õ',
    movement:'–†–£–•',actions:'–î–Ü–á',
    wakeup:'–†–û–ó–ë–£–î–ò–¢–ò',sleep:'–°–ü–ê–¢–ò',charge:'–ù–ê –ó–ê–†–Ø–î–ö–£',random:'–¢–ê–ù–¶–Æ–í–ê–¢–ò',
    zonemap:'–ö–ê–†–¢–ê –ó–û–ù–ò',zonewidth:'–®–ò–†–ò–ù–ê',zonedepth:'–ì–õ–ò–ë–ò–ù–ê',
    edgealerts:'–ó–ê–•–ò–°–¢ –ö–†–ê–Æ',on:'–£–í–Ü–ú–ö–ù',falls:'–ü–ê–î–Ü–ù–¨',
    language:'–ú–û–í–ê',features:'–§–£–ù–ö–¶–Ü–á',
    voiceact:'–ì–æ–ª–æ—Å–æ–≤–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è',voiceact_desc:'–ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Ñ—Ä–∞–∑–æ—é "–ü—Ä–∏–≤—ñ—Ç ZIVO"',
    edgeprot:'–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–∞–¥—ñ–Ω–Ω—è',edgeprot_desc:'–ó—É–ø–∏–Ω—è—Ç–∏—Å—å –±—ñ–ª—è –∫—Ä–∞—é —Å—Ç–æ–ª—É',
    autocharge:'–ê–≤—Ç–æ –∑–∞—Ä—è–¥–∫–∞',autocharge_desc:'–á—Ö–∞—Ç–∏ –Ω–∞ –±–∞–∑—É –ø—Ä–∏ –Ω–∏–∑—å–∫–æ–º—É –∑–∞—Ä—è–¥—ñ',
    explore:'–í–∏–ø–∞–¥–∫–æ–≤—ñ –ø—Ä–æ–≥—É–ª—è–Ω–∫–∏',explore_desc:'ZIVO —ó–∑–¥–∏—Ç—å —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ',
    notifs:'–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è',notifs_desc:'–ó–∞—Ä—è–¥ —ñ –∑–∞—Ö–∏—Å—Ç –∫—Ä–∞—é',
    nav_control:'–ö–ï–†–£–í–ê–ù–ù–Ø',nav_zone:'–ó–û–ù–ê',nav_settings:'–ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø',
    moods:['–ì–û–¢–û–í–ò–ô ‚Ä¢ –°–õ–£–•–ê–Æ','–î–û–°–õ–Ü–î–ñ–£–Æ','–©–ê–°–õ–ò–í–ò–ô','–ß–ï–ö–ê–Æ'],
    log_connected:'–ü—ñ–¥–∫–ª—é—á–µ–Ω–æ –¥–æ {name}',
    upfmt:(h,m)=>h+'–≥'+String(m).padStart(2,'0')+'—Ö–≤',
    offline:'–ù–ï –ü–Ü–î–ö–õ–Æ–ß–ï–ù–û',not_connected:'ZIVO –Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ',
    not_connected_desc:'–í–≤–µ–¥–∏ —Å–µ—Ä—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä',connect_btn:'–ü–Ü–î–ö–õ–Æ–ß–ò–¢–ò',
    serial_label:'–°–ï–†–Ü–ô–ù–ò–ô –ù–û–ú–ï–†',serial_wrong:'–ù–µ–≤—ñ—Ä–Ω–∏–π —Å–µ—Ä—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä.',
    serial_hint:'–°–µ—Ä—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä –Ω–∞ –Ω–∞–∫–ª–µ–π—Ü—ñ –Ω–∞ –¥–Ω—ñ –∫–æ—Ä–ø—É—Å—É'
  }
};

let lang='en',moodIdx=0,connected=false,currentRobot=null,currentSerial=null;

function setConnected(val){
  connected=val;
  const dot=document.getElementById('status-dot');
  const txt=document.getElementById('status-text');
  const face=document.getElementById('zivo-face');
  if(val){
    dot.style.cssText='background:var(--success);box-shadow:0 0 8px var(--success);animation:pulse 2s infinite;width:10px;height:10px;border-radius:50%';
    txt.style.color='var(--success)';txt.textContent=T[lang].online;
    document.getElementById('offline-banner').style.display='none';
    document.getElementById('pages-wrapper').style.display='block';
    document.getElementById('page-home').style.display='block';
    document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
    document.querySelector('.nav-item').classList.add('active');
    face.style.borderColor='var(--blue)';
    face.style.boxShadow='0 0 30px var(--blue-glow),inset 0 0 30px rgba(0,180,255,0.05)';
  }else{
    dot.style.cssText='background:var(--gray);box-shadow:none;animation:none;width:10px;height:10px;border-radius:50%';
    txt.style.color='var(--gray)';txt.textContent=T[lang].offline;
    document.getElementById('offline-banner').style.display='block';
    document.getElementById('pages-wrapper').style.display='none';
    document.getElementById('page-settings').style.display='none';
    face.style.borderColor='var(--gray)';face.style.boxShadow='none';
  }
}

function tryConnect(){
  const input=document.getElementById('serial-input').value.trim().toUpperCase();
  const err=document.getElementById('serial-error');
  const btn=document.getElementById('connect-btn');
  if(!input){err.style.display='block';return;}
  btn.textContent='...';btn.style.opacity='0.6';err.style.display='none';
  setTimeout(()=>{
    if(input in REGISTERED_ROBOTS){
      currentRobot=REGISTERED_ROBOTS[input];currentSerial=input;
      localStorage.setItem('zivo_last_serial',input);
      setConnected(true);
      addLog('ok',T[lang].log_connected.replace('{name}',currentRobot.name));
    }else{
      btn.textContent=T[lang].connect_btn;btn.style.opacity='1';
      err.style.display='block';
      const inp=document.getElementById('serial-input');
      inp.style.borderColor='var(--danger)';
      setTimeout(()=>inp.style.borderColor='rgba(0,180,255,0.3)',2000);
    }
  },1200);
}

function addLog(type,text){
  const list=document.getElementById('log-list');
  const now=new Date();
  const time=String(now.getHours()).padStart(2,'0')+':'+String(now.getMinutes()).padStart(2,'0');
  const el=document.createElement('div');
  el.className='log-entry';
  el.innerHTML='<span class="log-time">'+time+'</span><span class="log-text '+type+'">'+text+'</span>';
  list.insertBefore(el,list.firstChild);
  while(list.children.length>20)list.removeChild(list.lastChild);
}

async function sendCmd(cmd){
  if(!connected||!currentSerial)return;
  try{await fetch('http://zivo.local:8080/command',{method:'POST',headers:{'Content-Type':'application/json','X-Serial':currentSerial},body:JSON.stringify({cmd}),signal:AbortSignal.timeout(2000)});}catch(e){}
}

async function pollRobot(){
  if(!connected||!currentSerial)return;
  try{
    const resp=await fetch('http://zivo.local:8080/status',{headers:{'X-Serial':currentSerial},signal:AbortSignal.timeout(2000)});
    if(!resp.ok)return;
    const data=await resp.json();
    const batt=data.battery??0;
    document.getElementById('batt-text').textContent=batt+'%';
    document.getElementById('batt-fill').style.width=batt+'%';
    document.getElementById('batt-text').style.color=batt<20?'var(--danger)':batt<50?'#ffaa00':'var(--success)';
    document.getElementById('temp-val').textContent=(data.temp??'--')+'¬∞';
    if(data.uptime){const h=Math.floor(data.uptime/3600),m=Math.floor((data.uptime%3600)/60);document.getElementById('uptime-val').textContent=T[lang].upfmt(h,m);}
  }catch(e){}
}

function applyLang(l){
  lang=l;const t=T[l];
  document.querySelectorAll('[data-t]').forEach(el=>{const k=el.getAttribute('data-t');if(t[k]!==undefined)el.textContent=t[k];});
  document.getElementById('mood-text').textContent=t.moods[moodIdx];
  document.body.style.direction=l==='he'?'rtl':'ltr';
  document.getElementById('status-text').textContent=connected?t.online:t.offline;
  document.getElementById('connect-btn').textContent=t.connect_btn;
}

function selectLang(btn,l){
  document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');applyLang(l);
}

function switchPage(name,el){
  document.querySelectorAll('.page').forEach(p=>p.style.display='none');
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  el.classList.add('active');
  if(name==='settings'){document.getElementById('page-settings').style.display='block';}
  else if(connected){document.getElementById('pages-wrapper').style.display='block';document.getElementById('page-'+name).style.display='block';}
}

const lastSerial=localStorage.getItem('zivo_last_serial');
if(lastSerial)document.getElementById('serial-input').value=lastSerial;

setInterval(pollRobot,3000);
setInterval(()=>{moodIdx=(moodIdx+1)%4;document.getElementById('mood-text').textContent=T[lang].moods[moodIdx];},4000);

applyLang('en');
setConnected(false);

if('serviceWorker' in navigator)navigator.serviceWorker.register('/sw.js');
</script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>ZIVO</title>
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#00b4ff">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="ZIVO">
<meta name="mobile-web-app-capable" content="yes">
<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;600;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root{--bg:#050a14;--bg2:#0a1628;--blue:#00b4ff;--blue2:#0066cc;--blue-glow:rgba(0,180,255,0.3);--white:#e8f4ff;--gray:#3a5a7a;--danger:#ff4466;--success:#00ffaa;--card:rgba(10,22,40,0.8)}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--white);font-family:'Exo 2',sans-serif;min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(0,180,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(0,180,255,0.03) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0}
.app{position:relative;z-index:1;max-width:420px;margin:0 auto;min-height:100vh;display:flex;flex-direction:column}
.header{padding:20px 24px 16px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid rgba(0,180,255,0.1)}
.logo{font-size:28px;font-weight:900;letter-spacing:4px;color:var(--white);text-shadow:0 0 20px var(--blue),0 0 40px var(--blue2)}
.logo span{color:var(--blue)}
.status-dot{width:10px;height:10px;border-radius:50%}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.5;transform:scale(0.8)}}
.header-right{display:flex;align-items:center;gap:10px;font-size:11px;font-family:'Share Tech Mono',monospace}
.page{display:none;flex:1;padding:0 16px 100px}
.zivo-face-container{display:flex;flex-direction:column;align-items:center;padding:24px 0}
.zivo-face{width:160px;height:160px;background:linear-gradient(135deg,#0d1f3a,#1a3a5c);border-radius:32px;border:2px solid var(--gray);display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;transition:all 0.5s}
.zivo-face::before{content:'';position:absolute;top:0;left:-100%;width:60%;height:100%;background:linear-gradient(90deg,transparent,rgba(0,180,255,0.1),transparent);animation:scan 3s infinite}
@keyframes scan{0%{left:-100%}100%{left:200%}}
.eyes{display:flex;gap:28px;position:relative;z-index:1}
.eye{width:32px;height:32px;background:var(--blue);border-radius:8px;box-shadow:0 0 20px var(--blue);animation:blink 4s infinite;position:relative;overflow:hidden}
.eye::after{content:'';position:absolute;top:4px;left:4px;width:10px;height:10px;background:rgba(255,255,255,0.6);border-radius:3px}
@keyframes blink{0%,90%,100%{transform:scaleY(1)}95%{transform:scaleY(0.1)}}
.zivo-name{margin-top:14px;font-size:22px;font-weight:900;letter-spacing:6px;color:var(--blue);text-shadow:0 0 16px var(--blue-glow)}
.zivo-mood{margin-top:4px;font-size:11px;font-family:'Share Tech Mono',monospace;color:var(--gray);letter-spacing:2px}
.stats-row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin:16px 0}
.stat-card{background:var(--card);border:1px solid rgba(0,180,255,0.15);border-radius:16px;padding:14px 10px;text-align:center;backdrop-filter:blur(10px)}
.stat-value{font-size:20px;font-weight:700;color:var(--blue);font-family:'Share Tech Mono',monospace}
.stat-label{font-size:9px;color:var(--gray);letter-spacing:1px;text-transform:uppercase;margin-top:3px}
.battery-card{background:var(--card);border:1px solid rgba(0,180,255,0.15);border-radius:16px;padding:16px;margin-bottom:12px;backdrop-filter:blur(10px)}
.battery-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.battery-title{font-size:11px;letter-spacing:2px;text-transform:uppercase;color:var(--gray)}
.battery-percent{font-family:'Share Tech Mono',monospace;font-size:18px;color:var(--success)}
.battery-bar{height:8px;background:rgba(0,180,255,0.1);border-radius:4px;overflow:hidden}
.battery-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--blue2),var(--blue));border-radius:4px;box-shadow:0 0 8px var(--blue-glow);transition:width 0.5s}
.section-title{font-size:11px;letter-spacing:3px;text-transform:uppercase;color:var(--gray);margin:20px 0 12px}
.dpad{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;width:200px;margin:0 auto 24px}
.dpad-btn{height:56px;background:var(--card);border:1px solid rgba(0,180,255,0.2);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;cursor:pointer;transition:all 0.15s;user-select:none}
.dpad-btn:active{background:var(--blue);box-shadow:0 0 20px var(--blue-glow);transform:scale(0.95)}
.dpad-center{background:rgba(0,180,255,0.1);border-color:var(--blue);font-size:12px;font-weight:700;color:var(--blue);letter-spacing:1px}
.dpad-empty{background:transparent;border:none}
.action-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px}
.action-btn{padding:16px;background:var(--card);border:1px solid rgba(0,180,255,0.2);border-radius:16px;text-align:center;cursor:pointer;transition:all 0.2s}
.action-btn:active{transform:scale(0.97);border-color:var(--blue)}
.action-icon{font-size:24px;margin-bottom:6px}
.action-label{font-size:11px;letter-spacing:1px;text-transform:uppercase;color:var(--gray)}
.lang-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px}
.lang-btn{padding:14px;background:var(--card);border:1px solid rgba(0,180,255,0.15);border-radius:14px;text-align:center;cursor:pointer;transition:all 0.2s}
.lang-btn.active{border-color:var(--blue);background:rgba(0,180,255,0.1);box-shadow:0 0 12px var(--blue-glow)}
.lang-flag{font-size:26px}
.lang-name{font-size:11px;color:var(--gray);margin-top:4px;letter-spacing:1px}
.toggle-row{display:flex;align-items:center;justify-content:space-between;padding:16px;background:var(--card);border:1px solid rgba(0,180,255,0.15);border-radius:14px;margin-bottom:10px}
.toggle-label{font-size:14px;font-weight:600}
.toggle-desc{font-size:11px;color:var(--gray);margin-top:2px}
.toggle{width:48px;height:26px;background:var(--gray);border-radius:13px;position:relative;cursor:pointer;transition:background 0.2s;flex-shrink:0}
.toggle.on{background:var(--blue);box-shadow:0 0 10px var(--blue-glow)}
.toggle::after{content:'';position:absolute;top:3px;left:3px;width:20px;height:20px;background:white;border-radius:50%;transition:transform 0.2s}
.toggle.on::after{transform:translateX(22px)}
.boundary-map{width:100%;aspect-ratio:1;background:var(--card);border:1px solid rgba(0,180,255,0.2);border-radius:20px;position:relative;overflow:hidden;margin-bottom:16px}
.boundary-map::before{content:'';position:absolute;inset:0;background-image:linear-gradient(rgba(0,180,255,0.05) 1px,transparent 1px),linear-gradient(90deg,rgba(0,180,255,0.05) 1px,transparent 1px);background-size:30px 30px}
.boundary-zone{position:absolute;inset:30px;border:2px dashed var(--blue);border-radius:12px;box-shadow:0 0 20px var(--blue-glow),inset 0 0 20px rgba(0,180,255,0.05)}
.zivo-dot{position:absolute;width:20px;height:20px;background:var(--blue);border-radius:6px;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:0 0 16px var(--blue);animation:float 3s ease-in-out infinite}
@keyframes float{0%,100%{transform:translate(-50%,-50%) translateY(0)}50%{transform:translate(-50%,-50%) translateY(-6px)}}
.corner-handle{position:absolute;width:14px;height:14px;background:var(--blue);border-radius:3px;box-shadow:0 0 8px var(--blue)}
.boundary-info{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.info-card{background:var(--card);border:1px solid rgba(0,180,255,0.15);border-radius:14px;padding:14px}
.info-card-label{font-size:10px;color:var(--gray);letter-spacing:1px;text-transform:uppercase}
.info-card-value{font-size:18px;font-weight:700;color:var(--blue);font-family:'Share Tech Mono',monospace;margin-top:4px}
.bottom-nav{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:420px;background:rgba(5,10,20,0.95);border-top:1px solid rgba(0,180,255,0.15);display:flex;padding:10px 0 20px;backdrop-filter:blur(20px);z-index:100}
.nav-item{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;cursor:pointer;padding:6px 0;transition:all 0.2s}
.nav-icon{font-size:22px;filter:grayscale(1) opacity(0.4);transition:all 0.2s}
.nav-label{font-size:9px;letter-spacing:1px;text-transform:uppercase;color:var(--gray)}
.nav-item.active .nav-icon{filter:none}
.nav-item.active .nav-label{color:var(--blue)}
.log-entry{display:flex;gap:10px;padding:10px 14px;background:var(--card);border:1px solid rgba(0,180,255,0.1);border-radius:12px;margin-bottom:8px;align-items:flex-start}
.log-time{font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--gray);white-space:nowrap;padding-top:2px}
.log-text{font-size:13px;line-height:1.4}
.log-text.info{color:var(--blue)}
.log-text.warn{color:#ffaa00}
.log-text.ok{color:var(--success)}
</style>
</head>
<body>
<div class="app">
  <div class="header">
    <div class="logo">ZI<span>V</span>O</div>
    <div class="header-right">
      <div class="status-dot" id="status-dot" style="background:var(--gray);box-shadow:none;animation:none;"></div>
      <span id="status-text" style="color:var(--gray)"></span>
    </div>
  </div>

  <div class="zivo-face-container">
    <div class="zivo-face" id="zivo-face">
      <div class="eyes"><div class="eye"></div><div class="eye"></div></div>
    </div>
    <div class="zivo-name">ZIVO</div>
    <div class="zivo-mood" id="mood-text"></div>
  </div>

  <div id="offline-banner" style="text-align:center;padding:16px 20px;color:var(--gray);">
    <div style="font-size:40px;margin-bottom:10px;">üì°</div>
    <div style="font-size:13px;font-weight:600;letter-spacing:2px;margin-bottom:4px;" data-t="not_connected"></div>
    <div style="font-size:11px;opacity:0.6;margin-bottom:20px;" data-t="not_connected_desc"></div>
    <div style="background:var(--card);border:1px solid rgba(0,180,255,0.2);border-radius:16px;padding:18px;text-align:left;">
      <div style="font-size:10px;letter-spacing:2px;color:var(--gray);margin-bottom:8px;" data-t="serial_label"></div>
      <input id="serial-input" type="text" maxlength="12"
        style="width:100%;background:rgba(0,180,255,0.05);border:1px solid rgba(0,180,255,0.3);border-radius:10px;padding:12px 14px;color:var(--white);font-family:'Share Tech Mono',monospace;font-size:16px;letter-spacing:3px;outline:none;text-transform:uppercase;"
        placeholder="ZIVO-XXXXXX" oninput="this.value=this.value.toUpperCase()"/>
      <div id="serial-error" style="font-size:11px;color:var(--danger);margin-top:8px;display:none;" data-t="serial_wrong"></div>
      <button onclick="tryConnect()" id="connect-btn"
        style="width:100%;margin-top:14px;padding:13px;background:rgba(0,180,255,0.1);border:1px solid var(--blue);border-radius:12px;cursor:pointer;font-size:12px;letter-spacing:2px;color:var(--blue);font-family:'Exo 2',sans-serif;font-weight:700;"
        data-t="connect_btn"></button>
    </div>
    <div style="margin-top:14px;font-size:11px;opacity:0.5;" data-t="serial_hint"></div>
  </div>

  <div id="pages-wrapper" style="display:none">
    <div id="page-home" class="page" style="display:block">
      <div class="stats-row">
        <div class="stat-card"><div class="stat-value" id="temp-val">--</div><div class="stat-label" data-t="temp"></div></div>
        <div class="stat-card"><div class="stat-value" id="uptime-val">--</div><div class="stat-label" data-t="uptime"></div></div>
        <div class="stat-card"><div class="stat-value">‚úì</div><div class="stat-label">Wi-Fi</div></div>
      </div>
      <div class="battery-card">
        <div class="battery-header">
          <span class="battery-title" data-t="battery"></span>
          <span class="battery-percent" id="batt-text">--%</span>
        </div>
        <div class="battery-bar"><div class="battery-fill" id="batt-fill"></div></div>
      </div>
      <div class="section-title" data-t="log"></div>
      <div id="log-list"></div>
    </div>

    <div id="page-control" class="page">
      <div class="section-title" data-t="movement"></div>
      <div class="dpad">
        <div class="dpad-btn dpad-empty"></div>
        <div class="dpad-btn" onclick="sendCmd('forward')">‚ñ≤</div>
        <div class="dpad-btn dpad-empty"></div>
        <div class="dpad-btn" onclick="sendCmd('left')">‚óÑ</div>
        <div class="dpad-btn dpad-center">ZIVO</div>
        <div class="dpad-btn" onclick="sendCmd('right')">‚ñ∫</div>
        <div class="dpad-btn dpad-empty"></div>
        <div class="dpad-btn" onclick="sendCmd('backward')">‚ñº</div>
        <div class="dpad-btn dpad-empty"></div>
      </div>
      <div class="section-title" data-t="actions"></div>
      <div class="action-grid">
        <div class="action-btn" onclick="sendCmd('wake')"><div class="action-icon">üé§</div><div class="action-label" data-t="wakeup"></div></div>
        <div class="action-btn" onclick="sendCmd('sleep')"><div class="action-icon">üò¥</div><div class="action-label" data-t="sleep"></div></div>
        <div class="action-btn" onclick="sendCmd('charge')"><div class="action-icon">üîã</div><div class="action-label" data-t="charge"></div></div>
        <div class="action-btn" onclick="sendCmd('dance')"><div class="action-icon">üé≤</div><div class="action-label" data-t="random"></div></div>
      </div>
    </div>

    <div id="page-boundary" class="page">
      <div class="section-title" data-t="zonemap"></div>
      <div class="boundary-map">
        <div class="boundary-zone">
          <div class="corner-handle" style="top:-7px;left:-7px"></div>
          <div class="corner-handle" style="top:-7px;right:-7px"></div>
          <div class="corner-handle" style="bottom:-7px;left:-7px"></div>
          <div class="corner-handle" style="bottom:-7px;right:-7px"></div>
        </div>
        <div class="zivo-dot"></div>
      </div>
      <div class="boundary-info">
        <div class="info-card"><div class="info-card-label" data-t="zonewidth"></div><div class="info-card-value">80cm</div></div>
        <div class="info-card"><div class="info-card-label" data-t="zonedepth"></div><div class="info-card-value">60cm</div></div>
        <div class="info-card"><div class="info-card-label" data-t="edgealerts"></div><div class="info-card-value" style="color:var(--success)" data-t="on"></div></div>
        <div class="info-card"><div class="info-card-label" data-t="falls"></div><div class="info-card-value">0</div></div>
      </div>
    </div>
  </div>

  <div id="page-settings" class="page" style="display:none">
    <div class="section-title" data-t="language"></div>
    <div class="lang-grid">
      <div class="lang-btn" onclick="selectLang(this,'ru')"><div class="lang-flag">üá∑üá∫</div><div class="lang-name">–†—É—Å—Å–∫–∏–π</div></div>
      <div class="lang-btn active" onclick="selectLang(this,'en')"><div class="lang-flag">üá∫üá∏</div><div class="lang-name">English</div></div>
      <div class="lang-btn" onclick="selectLang(this,'he')"><div class="lang-flag">üáÆüá±</div><div class="lang-name">◊¢◊ë◊®◊ô◊™</div></div>
      <div class="lang-btn" onclick="selectLang(this,'zh')"><div class="lang-flag">üá®üá≥</div><div class="lang-name">‰∏≠Êñá</div></div>
      <div class="lang-btn" onclick="selectLang(this,'uk')"><div class="lang-flag">üá∫üá¶</div><div class="lang-name">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</div></div>
    </div>
    <div class="section-title" data-t="features"></div>
    <div class="toggle-row"><div class="toggle-info"><div class="toggle-label" data-t="voiceact"></div><div class="toggle-desc" data-t="voiceact_desc"></div></div><div class="toggle on" onclick="this.classList.toggle('on')"></div></div>
    <div class="toggle-row"><div class="toggle-info"><div class="toggle-label" data-t="edgeprot"></div><div class="toggle-desc" data-t="edgeprot_desc"></div></div><div class="toggle on" onclick="this.classList.toggle('on')"></div></div>
    <div class="toggle-row"><div class="toggle-info"><div class="toggle-label" data-t="autocharge"></div><div class="toggle-desc" data-t="autocharge_desc"></div></div><div class="toggle on" onclick="this.classList.toggle('on')"></div></div>
    <div class="toggle-row"><div class="toggle-info"><div class="toggle-label" data-t="explore"></div><div class="toggle-desc" data-t="explore_desc"></div></div><div class="toggle" onclick="this.classList.toggle('on')"></div></div>
    <div class="toggle-row"><div class="toggle-info"><div class="toggle-label" data-t="notifs"></div><div class="toggle-desc" data-t="notifs_desc"></div></div><div class="toggle on" onclick="this.classList.toggle('on')"></div></div>
  </div>

  <div class="bottom-nav">
    <div class="nav-item active" onclick="switchPage('home',this)"><div class="nav-icon">ü§ñ</div><div class="nav-label">ZIVO</div></div>
    <div class="nav-item" onclick="switchPage('control',this)"><div class="nav-icon">üïπÔ∏è</div><div class="nav-label" data-t="nav_control"></div></div>
    <div class="nav-item" onclick="switchPage('boundary',this)"><div class="nav-icon">üìç</div><div class="nav-label" data-t="nav_zone"></div></div>
    <div class="nav-item" onclick="switchPage('settings',this)"><div class="nav-icon">‚öôÔ∏è</div><div class="nav-label" data-t="nav_settings"></div></div>
  </div>
</div>

<script>
const REGISTERED_ROBOTS = {
  'ZIVO-ADMINMW': { name: 'ZIVO #1', owner: 'Admin' },
};

const T = {
  ru: {
    online:'–í –°–ï–¢–ò',temp:'–¢–ï–ú–ü',uptime:'–í–†–ï–ú–Ø',battery:'–ë–ê–¢–ê–†–ï–Ø',log:'–ñ–£–†–ù–ê–õ',
    movement:'–î–í–ò–ñ–ï–ù–ò–ï',actions:'–î–ï–ô–°–¢–í–ò–Ø',
    wakeup:'–†–ê–ó–ë–£–î–ò–¢–¨',sleep:'–°–ü–ê–¢–¨',charge:'–ù–ê –ó–ê–†–Ø–î–ö–£',random:'–¢–ê–ù–¶–ï–í–ê–¢–¨',
    zonemap:'–ö–ê–†–¢–ê –ó–û–ù–´',zonewidth:'–®–ò–†–ò–ù–ê',zonedepth:'–ì–õ–£–ë–ò–ù–ê',
    edgealerts:'–ó–ê–©–ò–¢–ê –ö–†–ê–Ø',on:'–í–ö–õ',falls:'–ü–ê–î–ï–ù–ò–ô',
    language:'–Ø–ó–´–ö',features:'–§–£–ù–ö–¶–ò–ò',
    voiceact:'–ì–æ–ª–æ—Å–æ–≤–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è',voiceact_desc:'–ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ñ—Ä–∞–∑–æ–π "–ü—Ä–∏–≤–µ—Ç ZIVO"',
    edgeprot:'–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–∞–¥–µ–Ω–∏—è',edgeprot_desc:'–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è —É –∫—Ä–∞—è —Å—Ç–æ–ª–∞',
    autocharge:'–ê–≤—Ç–æ –∑–∞—Ä—è–¥–∫–∞',autocharge_desc:'–ï—Ö–∞—Ç—å –Ω–∞ –±–∞–∑—É –ø—Ä–∏ –Ω–∏–∑–∫–æ–º –∑–∞—Ä—è–¥–µ',
    explore:'–°–ª—É—á–∞–π–Ω—ã–µ –ø—Ä–æ–≥—É–ª–∫–∏',explore_desc:'ZIVO –µ–∑–¥–∏—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ',
    notifs:'–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è',notifs_desc:'–ó–∞—Ä—è–¥ –∏ –∑–∞—â–∏—Ç–∞ –∫—Ä–∞—è',
    nav_control:'–£–ü–†–ê–í–õ–ï–ù–ò–ï',nav_zone:'–ó–û–ù–ê',nav_settings:'–ù–ê–°–¢–†–û–ô–ö–ò',
    moods:['–ì–û–¢–û–í ‚Ä¢ –°–õ–£–®–ê–Æ','–ò–°–°–õ–ï–î–£–Æ','–°–ß–ê–°–¢–õ–ò–í','–ñ–î–£ –ö–û–ú–ê–ù–î–´'],
    log_connected:'–ü–æ–¥–∫–ª—é—á—ë–Ω –∫ {name}',
    upfmt:(h,m)=>h+'—á'+String(m).padStart(2,'0')+'–º',
    offline:'–ù–ï –ü–û–î–ö–õ–Æ–ß–Å–ù',not_connected:'ZIVO –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω',
    not_connected_desc:'–í–≤–µ–¥–∏ —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä',connect_btn:'–ü–û–î–ö–õ–Æ–ß–ò–¢–¨',
    serial_label:'–°–ï–†–ò–ô–ù–´–ô –ù–û–ú–ï–†',serial_wrong:'–ù–µ–≤–µ—Ä–Ω—ã–π —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä.',
    serial_hint:'–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –Ω–∞ –Ω–∞–∫–ª–µ–π–∫–µ –Ω–∞ –¥–Ω–µ –∫–æ—Ä–ø—É—Å–∞'
  },
  en: {
    online:'ONLINE',temp:'TEMP',uptime:'UPTIME',battery:'BATTERY',log:'LOG',
    movement:'MOVEMENT',actions:'ACTIONS',
    wakeup:'WAKE UP',sleep:'SLEEP',charge:'GO CHARGE',random:'DANCE',
    zonemap:'SAFE ZONE MAP',zonewidth:'WIDTH',zonedepth:'DEPTH',
    edgealerts:'EDGE ALERTS',on:'ON',falls:'FALLS',
    language:'LANGUAGE',features:'FEATURES',
    voiceact:'Voice Activation',voiceact_desc:'Wake up with "Hey ZIVO"',
    edgeprot:'Edge Protection',edgeprot_desc:'Stop at table edges',
    autocharge:'Auto Charging',autocharge_desc:'Return to base when low',
    explore:'Random Explore',explore_desc:'ZIVO moves on its own',
    notifs:'Notifications',notifs_desc:'Battery and edge alerts',
    nav_control:'CONTROL',nav_zone:'ZONE',nav_settings:'SETTINGS',
    moods:['READY ‚Ä¢ LISTENING','EXPLORING','HAPPY','IDLE ‚Ä¢ WAITING'],
    log_connected:'Connected to {name}',
    upfmt:(h,m)=>h+'h'+String(m).padStart(2,'0')+'m',
    offline:'DISCONNECTED',not_connected:'ZIVO is not connected',
    not_connected_desc:'Enter your ZIVO serial number',connect_btn:'CONNECT',
    serial_label:'SERIAL NUMBER',serial_wrong:'Wrong serial number.',
    serial_hint:'Serial number is on the sticker on the bottom'
  },
  he: {
    online:'◊û◊ó◊ï◊ë◊®',temp:'◊ò◊û◊§',uptime:'◊ñ◊û◊ü',battery:'◊°◊ï◊ú◊ú◊î',log:'◊ô◊ï◊û◊ü',
    movement:'◊™◊†◊ï◊¢◊î',actions:'◊§◊¢◊ï◊ú◊ï◊™',
    wakeup:'◊î◊™◊¢◊ï◊®◊®',sleep:'◊©◊ô◊†◊î',charge:'◊ú◊ò◊¢◊ô◊†◊î',random:'◊ú◊®◊ß◊ï◊ì',
    zonemap:'◊û◊§◊™ ◊ê◊ñ◊ï◊®',zonewidth:'◊®◊ï◊ó◊ë',zonedepth:'◊¢◊ï◊û◊ß',
    edgealerts:'◊î◊í◊†◊™ ◊ß◊¶◊î',on:'◊§◊ï◊¢◊ú',falls:'◊†◊§◊ô◊ú◊ï◊™',
    language:'◊©◊§◊î',features:'◊™◊õ◊ï◊†◊ï◊™',
    voiceact:'◊î◊§◊¢◊ú◊î ◊ß◊ï◊ú◊ô◊™',voiceact_desc:'◊î◊§◊¢◊ú◊î ◊¢◊ù "◊î◊ô◊ô ZIVO"',
    edgeprot:'◊î◊í◊†◊î ◊û◊†◊§◊ô◊ú◊î',edgeprot_desc:'◊¢◊¶◊ï◊® ◊ë◊ß◊¶◊î ◊î◊©◊ï◊ú◊ó◊ü',
    autocharge:'◊ò◊¢◊ô◊†◊î ◊ê◊ï◊ò◊ï◊û◊ò◊ô◊™',autocharge_desc:'◊ó◊ñ◊ï◊® ◊ú◊ë◊°◊ô◊° ◊õ◊©◊î◊°◊ï◊ú◊ú◊î ◊†◊û◊ï◊õ◊î',
    explore:'◊°◊ô◊ï◊® ◊ê◊ß◊®◊ê◊ô',explore_desc:'ZIVO ◊†◊ï◊°◊¢ ◊ú◊ë◊ì',
    notifs:'◊î◊™◊®◊ê◊ï◊™',notifs_desc:'◊°◊ï◊ú◊ú◊î ◊ï◊î◊í◊†◊™ ◊ß◊¶◊î',
    nav_control:'◊©◊ú◊ô◊ò◊î',nav_zone:'◊ê◊ñ◊ï◊®',nav_settings:'◊î◊í◊ì◊®◊ï◊™',
    moods:['◊û◊ï◊õ◊ü ‚Ä¢ ◊û◊ß◊©◊ô◊ë','◊ó◊ï◊ß◊®','◊©◊û◊ó','◊û◊û◊™◊ô◊ü'],
    log_connected:'◊û◊ó◊ï◊ë◊® ◊ú-{name}',
    upfmt:(h,m)=>h+'◊©'+String(m).padStart(2,'0')+'◊ì',
    offline:'◊û◊†◊ï◊™◊ß',not_connected:'ZIVO ◊ú◊ê ◊û◊ó◊ï◊ë◊®',
    not_connected_desc:'◊î◊ñ◊ü ◊ê◊™ ◊î◊û◊°◊§◊® ◊î◊°◊ô◊ì◊ï◊®◊ô',connect_btn:'◊î◊™◊ó◊ë◊®',
    serial_label:'◊û◊°◊§◊® ◊°◊ô◊ì◊ï◊®◊ô',serial_wrong:'◊û◊°◊§◊® ◊°◊ô◊ì◊ï◊®◊ô ◊©◊í◊ï◊ô.',
    serial_hint:'◊î◊û◊°◊§◊® ◊î◊°◊ô◊ì◊ï◊®◊ô ◊†◊û◊¶◊ê ◊ë◊™◊ó◊™◊ô◊™ ZIVO'
  },
  zh: {
    online:'Âú®Á∫ø',temp:'Ê∏©Â∫¶',uptime:'ËøêË°å',battery:'ÁîµÊ±†',log:'Êó•Âøó',
    movement:'ÁßªÂä®',actions:'Êìç‰Ωú',
    wakeup:'Âî§ÈÜí',sleep:'Áù°Áú†',charge:'ÂéªÂÖÖÁîµ',random:'Ë∑≥Ëàû',
    zonemap:'ÂÆâÂÖ®Âå∫Âüü',zonewidth:'ÂÆΩÂ∫¶',zonedepth:'Ê∑±Â∫¶',
    edgealerts:'ËæπÁºò‰øùÊä§',on:'ÂºÄÂêØ',falls:'Ë∑åËêΩ',
    language:'ËØ≠Ë®Ä',features:'ÂäüËÉΩ',
    voiceact:'ËØ≠Èü≥ÊøÄÊ¥ª',voiceact_desc:'ËØ¥"Âòø ZIVO"Âî§ÈÜí',
    edgeprot:'Èò≤Ë∑åËêΩ',edgeprot_desc:'Âú®Ê°åÂ≠êËæπÁºòÂÅú‰∏ã',
    autocharge:'Ëá™Âä®ÂÖÖÁîµ',autocharge_desc:'ÁîµÈáè‰ΩéÊó∂ËøîÂõûÂÖÖÁîµ',
    explore:'ÈöèÊú∫Êé¢Á¥¢',explore_desc:'ZIVO Ëá™‰∏ªÁßªÂä®',
    notifs:'ÈÄöÁü•',notifs_desc:'ÁîµÊ±†ÂíåËæπÁºòË≠¶Êä•',
    nav_control:'ÊéßÂà∂',nav_zone:'Âå∫Âüü',nav_settings:'ËÆæÁΩÆ',
    moods:['ÂáÜÂ§áÂ•Ω‰∫Ü','Êé¢Á¥¢‰∏≠','ÂºÄÂøÉ','Á≠âÂæÖÂëΩ‰ª§'],
    log_connected:'Â∑≤ËøûÊé•Âà∞ {name}',
    upfmt:(h,m)=>h+'Êó∂'+String(m).padStart(2,'0')+'ÂàÜ',
    offline:'Êú™ËøûÊé•',not_connected:'ZIVO Êú™ËøûÊé•',
    not_connected_desc:'ËæìÂÖ•Â∫èÂàóÂè∑',connect_btn:'ËøûÊé•',
    serial_label:'Â∫èÂàóÂè∑',serial_wrong:'Â∫èÂàóÂè∑ÈîôËØØ„ÄÇ',
    serial_hint:'Â∫èÂàóÂè∑Âú® ZIVO Â∫ïÈÉ®ÁöÑË¥¥Á∫∏‰∏ä'
  },
  uk: {
    online:'–í –ú–ï–†–ï–ñ–Ü',temp:'–¢–ï–ú–ü',uptime:'–ß–ê–°',battery:'–ë–ê–¢–ê–†–ï–Ø',log:'–ñ–£–†–ù–ê–õ',
    movement:'–†–£–•',actions:'–î–Ü–á',
    wakeup:'–†–û–ó–ë–£–î–ò–¢–ò',sleep:'–°–ü–ê–¢–ò',charge:'–ù–ê –ó–ê–†–Ø–î–ö–£',random:'–¢–ê–ù–¶–Æ–í–ê–¢–ò',
    zonemap:'–ö–ê–†–¢–ê –ó–û–ù–ò',zonewidth:'–®–ò–†–ò–ù–ê',zonedepth:'–ì–õ–ò–ë–ò–ù–ê',
    edgealerts:'–ó–ê–•–ò–°–¢ –ö–†–ê–Æ',on:'–£–í–Ü–ú–ö–ù',falls:'–ü–ê–î–Ü–ù–¨',
    language:'–ú–û–í–ê',features:'–§–£–ù–ö–¶–Ü–á',
    voiceact:'–ì–æ–ª–æ—Å–æ–≤–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è',voiceact_desc:'–ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Ñ—Ä–∞–∑–æ—é "–ü—Ä–∏–≤—ñ—Ç ZIVO"',
    edgeprot:'–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–∞–¥—ñ–Ω–Ω—è',edgeprot_desc:'–ó—É–ø–∏–Ω—è—Ç–∏—Å—å –±—ñ–ª—è –∫—Ä–∞—é —Å—Ç–æ–ª—É',
    autocharge:'–ê–≤—Ç–æ –∑–∞—Ä—è–¥–∫–∞',autocharge_desc:'–á—Ö–∞—Ç–∏ –Ω–∞ –±–∞–∑—É –ø—Ä–∏ –Ω–∏–∑—å–∫–æ–º—É –∑–∞—Ä—è–¥—ñ',
    explore:'–í–∏–ø–∞–¥–∫–æ–≤—ñ –ø—Ä–æ–≥—É–ª—è–Ω–∫–∏',explore_desc:'ZIVO —ó–∑–¥–∏—Ç—å —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ',
    notifs:'–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è',notifs_desc:'–ó–∞—Ä—è–¥ —ñ –∑–∞—Ö–∏—Å—Ç –∫—Ä–∞—é',
    nav_control:'–ö–ï–†–£–í–ê–ù–ù–Ø',nav_zone:'–ó–û–ù–ê',nav_settings:'–ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø',
    moods:['–ì–û–¢–û–í–ò–ô ‚Ä¢ –°–õ–£–•–ê–Æ','–î–û–°–õ–Ü–î–ñ–£–Æ','–©–ê–°–õ–ò–í–ò–ô','–ß–ï–ö–ê–Æ'],
    log_connected:'–ü—ñ–¥–∫–ª—é—á–µ–Ω–æ –¥–æ {name}',
    upfmt:(h,m)=>h+'–≥'+String(m).padStart(2,'0')+'—Ö–≤',
    offline:'–ù–ï –ü–Ü–î–ö–õ–Æ–ß–ï–ù–û',not_connected:'ZIVO –Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ',
    not_connected_desc:'–í–≤–µ–¥–∏ —Å–µ—Ä—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä',connect_btn:'–ü–Ü–î–ö–õ–Æ–ß–ò–¢–ò',
    serial_label:'–°–ï–†–Ü–ô–ù–ò–ô –ù–û–ú–ï–†',serial_wrong:'–ù–µ–≤—ñ—Ä–Ω–∏–π —Å–µ—Ä—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä.',
    serial_hint:'–°–µ—Ä—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä –Ω–∞ –Ω–∞–∫–ª–µ–π—Ü—ñ –Ω–∞ –¥–Ω—ñ –∫–æ—Ä–ø—É—Å—É'
  }
};

let lang='en',moodIdx=0,connected=false,currentRobot=null,currentSerial=null;

function setConnected(val){
  connected=val;
  const dot=document.getElementById('status-dot');
  const txt=document.getElementById('status-text');
  const face=document.getElementById('zivo-face');
  if(val){
    dot.style.cssText='background:var(--success);box-shadow:0 0 8px var(--success);animation:pulse 2s infinite;width:10px;height:10px;border-radius:50%';
    txt.style.color='var(--success)';txt.textContent=T[lang].online;
    document.getElementById('offline-banner').style.display='none';
    document.getElementById('pages-wrapper').style.display='block';
    document.getElementById('page-home').style.display='block';
    document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
    document.querySelector('.nav-item').classList.add('active');
    face.style.borderColor='var(--blue)';
    face.style.boxShadow='0 0 30px var(--blue-glow),inset 0 0 30px rgba(0,180,255,0.05)';
  }else{
    dot.style.cssText='background:var(--gray);box-shadow:none;animation:none;width:10px;height:10px;border-radius:50%';
    txt.style.color='var(--gray)';txt.textContent=T[lang].offline;
    document.getElementById('offline-banner').style.display='block';
    document.getElementById('pages-wrapper').style.display='none';
    document.getElementById('page-settings').style.display='none';
    face.style.borderColor='var(--gray)';face.style.boxShadow='none';
  }
}

function tryConnect(){
  const input=document.getElementById('serial-input').value.trim().toUpperCase();
  const err=document.getElementById('serial-error');
  const btn=document.getElementById('connect-btn');
  if(!input){err.style.display='block';return;}
  btn.textContent='...';btn.style.opacity='0.6';err.style.display='none';
  setTimeout(()=>{
    if(input in REGISTERED_ROBOTS){
      currentRobot=REGISTERED_ROBOTS[input];currentSerial=input;
      localStorage.setItem('zivo_last_serial',input);
      setConnected(true);
      addLog('ok',T[lang].log_connected.replace('{name}',currentRobot.name));
    }else{
      btn.textContent=T[lang].connect_btn;btn.style.opacity='1';
      err.style.display='block';
      const inp=document.getElementById('serial-input');
      inp.style.borderColor='var(--danger)';
      setTimeout(()=>inp.style.borderColor='rgba(0,180,255,0.3)',2000);
    }
  },1200);
}

function addLog(type,text){
  const list=document.getElementById('log-list');
  const now=new Date();
  const time=String(now.getHours()).padStart(2,'0')+':'+String(now.getMinutes()).padStart(2,'0');
  const el=document.createElement('div');
  el.className='log-entry';
  el.innerHTML='<span class="log-time">'+time+'</span><span class="log-text '+type+'">'+text+'</span>';
  list.insertBefore(el,list.firstChild);
  while(list.children.length>20)list.removeChild(list.lastChild);
}

async function sendCmd(cmd){
  if(!connected||!currentSerial)return;
  try{await fetch('http://zivo.local:8080/command',{method:'POST',headers:{'Content-Type':'application/json','X-Serial':currentSerial},body:JSON.stringify({cmd}),signal:AbortSignal.timeout(2000)});}catch(e){}
}

async function pollRobot(){
  if(!connected||!currentSerial)return;
  try{
    const resp=await fetch('http://zivo.local:8080/status',{headers:{'X-Serial':currentSerial},signal:AbortSignal.timeout(2000)});
    if(!resp.ok)return;
    const data=await resp.json();
    const batt=data.battery??0;
    document.getElementById('batt-text').textContent=batt+'%';
    document.getElementById('batt-fill').style.width=batt+'%';
    document.getElementById('batt-text').style.color=batt<20?'var(--danger)':batt<50?'#ffaa00':'var(--success)';
    document.getElementById('temp-val').textContent=(data.temp??'--')+'¬∞';
    if(data.uptime){const h=Math.floor(data.uptime/3600),m=Math.floor((data.uptime%3600)/60);document.getElementById('uptime-val').textContent=T[lang].upfmt(h,m);}
  }catch(e){}
}

function applyLang(l){
  lang=l;const t=T[l];
  document.querySelectorAll('[data-t]').forEach(el=>{const k=el.getAttribute('data-t');if(t[k]!==undefined)el.textContent=t[k];});
  document.getElementById('mood-text').textContent=t.moods[moodIdx];
  document.body.style.direction=l==='he'?'rtl':'ltr';
  document.getElementById('status-text').textContent=connected?t.online:t.offline;
  document.getElementById('connect-btn').textContent=t.connect_btn;
}

function selectLang(btn,l){
  document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');applyLang(l);
}

function switchPage(name,el){
  document.querySelectorAll('.page').forEach(p=>p.style.display='none');
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  el.classList.add('active');
  if(name==='settings'){document.getElementById('page-settings').style.display='block';}
  else if(connected){document.getElementById('pages-wrapper').style.display='block';document.getElementById('page-'+name).style.display='block';}
}

const lastSerial=localStorage.getItem('zivo_last_serial');
if(lastSerial)document.getElementById('serial-input').value=lastSerial;

setInterval(pollRobot,3000);
setInterval(()=>{moodIdx=(moodIdx+1)%4;document.getElementById('mood-text').textContent=T[lang].moods[moodIdx];},4000);

applyLang('en');
setConnected(false);

if('serviceWorker' in navigator)navigator.serviceWorker.register('/sw.js');
</script>
</body>
</html>
